<div id="container" class="container py-4">
  <div id="header" class="conatainer-fluid">
    <app-h1 text="Food Details" />

    <div class="btn-container">
      <div class="form-switch">
        <input
          class="form-check-input"
          type="checkbox"
          [checked]="food.available"
        />
        <label class="form-check-label ms-2">{{
          food.available ? "Available" : "Unavailable"
        }}</label>
      </div>
      <app-button buttonText="Edit">
        <i class="fa-solid fa-pen"></i>
      </app-button>
    </div>
  </div>
  <div id="divider" class="row mx-auto">
    <!-- Left Section -->
    <div id="left-section" class="col-md-5">
      <img
        [src]="food.image_url || 'assets/food-images/pizza.png'"
        class="img-fluid rounded mb-3"
        alt="Beef Onion Pizza"
      />

      <h3 class="food-name">{{ food.name }}</h3>
      <p class="text-muted">
        <span class="fw-bold">70.00</span>
        <span><span class="text-warning">★</span> 5.0</span>
        (23 Reviews) • 23 Sales
      </p>

      <h5 class="food-details mt-3">Details</h5>
      <p id="p" class="text-muted">
        {{ food.description }}
      </p>

      <h5 class="fw-semibold mt-4">Size</h5>
      <div class="form-check">
        <input
          class="form-check-input"
          type="radio"
          name="size"
          id="small"
          checked
        />
        <label class="form-check-label" for="small"
          >Small - ₵{{ food.price.small }}</label
        >
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="size" id="medium" />
        <label class="form-check-label" for="medium"
          >Medium - ₵{{ food.price.medium }}</label
        >
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="size" id="large" />
        <label class="form-check-label" for="large"
          >Large - ₵{{ food.price.large }}</label
        >
      </div>
    </div>

    <!-- Right Section -->
    <div id="right-section" class="col-md-7">
      <div class="rating-range-container contianer-fluid">
        <div class="row">
          <!-- Left Column: Average + Total -->
          <div class="col-md-5">
            <div
              class="d-flex flex-column justify-content-center align-items-center mb-2"
            >
              <h2 class="fw-bold m-0">
                {{ averageRating.toFixed(1) }}
                <span class="text-muted fs-6">/5.0</span>
              </h2>
              <img
                [src]="`assets/ratings/rating-${averageRating}.png`"
                alt="Average Rating"
              />
              <h1>{{ totalRatings }}</h1>
            </div>
          </div>

          <!-- Right Column: Star Breakdown -->
          <div class="col-md-7">
            <div class="rating-breakdown mb-4">
              <div *ngFor="let item of ratingBreakdown">
                <div class="d-flex align-items-center gap-2">
                  <span>
                    <img
                      [src]="'assets/ratings/rating-' + item.stars + '.png'"
                      alt="rating"
                    />
                  </span>
                  <div class="progress w-100" style="height: 8px">
                    <div
                      class="progress-bar bg-warning"
                      role="progressbar"
                      [style.width.%]="
                        totalRatings ? (item.count / totalRatings) * 100 : 0
                      "
                    ></div>
                  </div>
                  <span>{{ item.count }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Ratings Section -->
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="fw-bold">Review & Ratings</h5>
      </div>

      <!-- Review Cards -->
      <div class="card-container container-fluid">
        <div class="row">
          <div
            class="review-card row mb-2"
            *ngFor="let comment of food.reviews; index as i"
            (click)="$event.stopPropagation()"
          >
            <div class="wrapper d-flex col-md-9">
              <img
                src="assets/images/avatar.png"
                alt="Reviewer"
                class="rounded-circle me-3"
                width="50"
                height="50"
              />
              <div>
                <h6 class="mb-1 fw-semibold">
                  {{ comment.name }}
                  <span class="text-warning"
                    >★ {{ comment.rating.toFixed(1) }}</span
                  >
                </h6>
                <p class="text-muted mb-1">{{ comment.comment }}</p>
                <small class="text-muted">{{ comment.date }}</small>
              </div>
            </div>
            <div
              class="btn-container col-md-3 d-flex"
              (click)="toggleCommentIndex(i)"
            >
              <span class="reply">
                <svg-icons name="reply" />
                <span class="text-primary">Reply</span>
              </span>
            </div>
            <div
              class="reply-box col-lg-12 mt-3"
              style="transition: 0.3s ease-in-out"
              [class.show]="openCommentIndex === i"
            >
              <textarea
                class="form-control"
                placeholder="Write reply"
              ></textarea>
              <button class="btn btn-primary mt-2">Submit</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Clone the above div for more reviews -->
    </div>
  </div>
</div>
